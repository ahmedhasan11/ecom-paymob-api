📌 Nullable Return (Type?) — في طبقات التطبيق
🔹 معنى Product?

علامة ? تعني أن القيمة قد تكون موجودة أو قد تكون null
أي أن “عدم وجود نتيجة” احتمال طبيعي، وليس خطأ.

🔹 لماذا نستخدمها في Repository؟
Task<Product?> GetProductByIdAsync(Guid id);


لأن:

قد لا يوجد سجل في قاعدة البيانات بهذا الـ id

"Not Found" حالة متوقعة

لذلك نرجّع null بدل Exception

🔹 لماذا نستخدمها في Service أيضًا؟
Task<ProductDto?> GetProductByIdAsync(Guid id);


لأن:

الخدمة تعتمد على نتيجة الريبو

لو الريبو رجّع null → لا يوجد منتج

إذًا الخدمة أيضًا ترجع null (لكن على شكل DTO)

🔹 لماذا لا نرمي Exception عند عدم وجود بيانات؟

لأن:

عدم وجود المنتج ليس خطأ برمجي

بل حالة طبيعية في عمليات القراءة (Queries)

Exceptions تُستخدم عند:

مدخلات غير صالحة

انتهاك قواعد

أخطاء غير متوقعة

🔹 تدفّق المعنى عبر الطبقات
الطبقة	النوع المرجع	المعنى
Database	—	قد لا يوجد سجل
Repository	Product?	المنتج قد لا يكون موجودًا
Service	ProductDto?	لا يوجد منتج لعرضه
API / Controller	null → 404	تحويل النتيجة لاستجابة HTTP مناسبة
🔹 القاعدة الذهبية

استخدم null عندما يكون “عدم وجود نتيجة” احتمالًا طبيعيًا
واستخدم Exception عندما يكون هناك خطأ أو استخدام غير صحيح